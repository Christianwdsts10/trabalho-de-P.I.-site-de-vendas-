<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finalizar Compra</title>
    <script>
        function calcularParcelas() {
            const total = parseFloat(document.getElementById('total').innerText.replace('Total: R$ ', '').replace(',', '.'));
            const parcelas = parseInt(document.getElementById('installments').value);
            if (parcelas > 0) {
                const valorParcela = (total / parcelas).toFixed(2); // Calcula o valor da parcela
                document.getElementById('valor_parcela').innerText = `Valor da parcela: R$ ${valorParcela.replace('.', ',')}`;
            } else {
                document.getElementById('valor_parcela').innerText = ''; // Limpa o valor das parcelas
            }
        }

        function toggleParcelas() {
            const paymentMethod = document.getElementById('payment_method').value;
            const creditOptions = document.getElementById('credit_options');
            const cardNumberField = document.getElementById('card_number_field');

            if (paymentMethod === 'credit' || paymentMethod === 'debit') {
                creditOptions.style.display = paymentMethod === 'credit' ? 'block' : 'none'; // Exibe opções de parcelamento apenas se for crédito
                cardNumberField.style.display = 'block'; // Exibe o campo do número do cartão
                if (paymentMethod === 'credit') {
                    calcularParcelas(); // Calcula parcelas ao mostrar
                } else {
                    document.getElementById('valor_parcela').innerText = ''; // Limpa o valor das parcelas
                }
            } else {
                creditOptions.style.display = 'none'; // Esconde opções de parcelamento
                cardNumberField.style.display = 'none'; // Esconde o campo do número do cartão
                document.getElementById('valor_parcela').innerText = ''; // Limpa o valor das parcelas
            }
        }
    </script>
</head>
<body>
    <h1>Finalizar Compra</h1>
    <p id="total">Total: R$ {{ total_price }}</p>

    <form action="{{ url_for('checkout') }}" method="POST">
        <label for="payment_method">Escolha a forma de pagamento:</label>
        <select name="payment_method" id="payment_method" required onchange="toggleParcelas()">
            <option value="boleto">Boleto</option>
            <option value="pix">Pix</option>
            <option value="debit">Cartão de Débito</option>
            <option value="credit">Cartão de Crédito</option>
        </select>

        <div id="credit_options" style="display: none;">
            <label for="installments">Parcelamento:</label>
            <select name="installments" id="installments" onchange="calcularParcelas()">
                <option value="1">1x</option>
                <option value="2">2x</option>
                <option value="3">3x</option>
                <option value="4">4x</option>
                <option value="5">5x</option>
                <option value="6">6x</option>
                <option value="7">7x</option>
                <option value="8">8x</option>
                <option value="9">9x</option>
                <option value="10">10x</option>
                <option value="11">11x</option>
                <option value="12">12x</option>
            </select>
        </div>
        
        <p id="valor_parcela"></p> <!-- Inicialmente vazio, será preenchido ao escolher crédito -->

        <!-- Campos adicionais -->
        <div>
            <label for="cpf">CPF:</label>
            <input type="text" id="cpf" name="cpf" required placeholder="Digite seu CPF">
        </div>
        
        <div id="card_number_field" style="display: none;">
            <label for="card_number">Número do Cartão:</label>
            <input type="text" id="card_number" name="card_number" required placeholder="Digite o número do cartão">
        </div>
        
        <div>
            <h3>Informações de Endereço</h3>
            <p>Por favor, forneça seu endereço completo:</p>
            <label for="address">Endereço:</label>
            <input type="text" id="address" name="address" required placeholder="Digite seu endereço">
        </div>

        <div>
            <label for="house_number">Número:</label>
            <input type="text" id="house_number" name="house_number" required placeholder="Número da casa">
        </div>

        <div>
            <label for="neighborhood">Bairro:</label>
            <input type="text" id="neighborhood" name="neighborhood" required placeholder="Digite seu bairro">
        </div>

        <div>
            <label for="cep">CEP:</label>
            <input type="text" id="cep" name="cep" required placeholder="Digite seu CEP">
        </div>

        <div>
            <label for="state">Estado:</label>
            <input type="text" id="state" name="state" required placeholder="Digite seu estado">
        </div>

        <div>
            <label for="city">Cidade:</label>
            <input type="text" id="city" name="city" required placeholder="Digite sua cidade">
        </div>

        <button type="submit">Finalizar Compra</button>
    </form>

    <script>
        // Chama a função para atualizar a exibição de parcelas ao carregar a página
        toggleParcelas();
    </script>
</body>
</html>







           

